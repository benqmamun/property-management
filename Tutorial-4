CREATE TABLE "PM_ITEM" 
   (	"ITEM_NO" NUMBER GENERATED ALWAYS AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ITEM_ID" VARCHAR2(50) NOT NULL ENABLE, 
	"ITEM_NAME" VARCHAR2(100) NOT NULL ENABLE, 
	"UOM_NO" NUMBER(30,0), 
	"STANDARD_COST" NUMBER, 
	"SS_CREATOR" NUMBER(30,0), 
	"SS_CREATED_ON" VARCHAR2(50), 
	"SS_MODIFIER" NUMBER(30,0), 
	"SS_MODIFIED_ON" VARCHAR2(50), 
	 CHECK (STANDARD_COST >= 0) ENABLE, 
	 PRIMARY KEY ("ITEM_NO")
  USING INDEX  ENABLE, 
	 UNIQUE ("ITEM_ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "PM_ITEM" ADD CONSTRAINT "FK_PM_ITEM_UOM" FOREIGN KEY ("UOM_NO")
	  REFERENCES "PM_UOM" ("UOM_NO") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_PM_ITEM_ID" 
BEFORE INSERT ON PM_ITEM
FOR EACH ROW
DECLARE
  v_max_no NUMBER := 0;
  v_next_no NUMBER;
BEGIN
  IF :NEW.ITEM_ID IS NULL THEN
    SELECT NVL(MAX(TO_NUMBER(SUBSTR(ITEM_ID, 5))), 0)
    INTO v_max_no
    FROM PM_ITEM
    WHERE REGEXP_LIKE(ITEM_ID, '^ITM-[0-9]+');

    v_next_no := v_max_no + 1;

    :NEW.ITEM_ID := 'ITM-' || LPAD(v_next_no, 5, '0');
  END IF;
END;
/
ALTER TRIGGER "TRG_PM_ITEM_ID" ENABLE;



  CREATE TABLE "PM_TENANT_OWNERS" 
   (	"TENANT_OWNER_NO" NUMBER GENERATED ALWAYS AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ITEM_NO" NUMBER(30,0) NOT NULL ENABLE, 
	"OWNER_NO" NUMBER(30,0) NOT NULL ENABLE, 
	"OWNERSHIP_TYPE" VARCHAR2(50), 
	"OWNERSHIP_SHARE" NUMBER, 
	"SS_CREATOR" NUMBER(30,0), 
	"SS_CREATED_ON" DATE, 
	"SS_MODIFIER" NUMBER(30,0), 
	"SS_MODIFIED_ON" DATE, 
	 CHECK (OWNERSHIP_SHARE BETWEEN 0 AND 100) ENABLE, 
	 PRIMARY KEY ("TENANT_OWNER_NO")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "PM_TENANT_OWNERS" ADD CONSTRAINT "FK_PM_TENANT_ITEM" FOREIGN KEY ("ITEM_NO")
	  REFERENCES "PM_ITEM" ("ITEM_NO") ENABLE;
  ALTER TABLE "PM_TENANT_OWNERS" ADD CONSTRAINT "FK_PM_TENANT_OWNER" FOREIGN KEY ("OWNER_NO")
	  REFERENCES "PM_OWNER" ("OWNER_NO") ENABLE;
